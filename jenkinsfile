pipeline{
  agent any

  environment {
        SONAR_TOKEN = credentials('sonar-server-user-token')
  }

  stages{
   stage('Clean'){
               steps{
                     sh './gradlew clean'
               }
           }

           stage('Test'){
                steps{
                      sh './gradlew test jacocoTestReport'

               }
           }

           stage('Sonar'){
                steps{
                      sh './gradlew sonar  -Dsonar.login=$SONAR_TOKEN'
                }
           }

           stage('Build'){
                steps{
                       sh './gradlew build'
               }
           }

          stage('Containerize'){
                steps{
                   sh './gradlew buildAndTagDockerImage'
                }
          }

  }
}